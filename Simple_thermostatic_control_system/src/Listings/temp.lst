C51 COMPILER V9.54   TEMP                                                                  06/24/2025 21:47:26 PAGE 1   


C51 COMPILER V9.54, COMPILATION OF MODULE TEMP
OBJECT MODULE PLACED IN .\Objects\temp.obj
COMPILER INVOKED BY: D:\Keil_v5\C51\BIN\C51.EXE temp.c OPTIMIZE(8,SPEED) BROWSE DEBUG OBJECTEXTEND PRINT(.\Listings\temp
                    -.lst) OBJECT(.\Objects\temp.obj)

line level    source

   1          #include"temp.h"
   2          /*******************************************************************************
   3          * ï¿½ï¿½ ï¿½ï¿½ ï¿½ï¿½         : Delay1ms
   4          * ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½                 : ï¿½ï¿½Ê±ï¿½ï¿½ï¿½ï¿½
   5          * ï¿½ï¿½    ï¿½ï¿½         : ï¿½ï¿½
   6          * ï¿½ï¿½    ï¿½ï¿½         : ï¿½ï¿½
   7          *******************************************************************************/
   8          
   9          void Delay1ms(uint y)
  10          {
  11   1              uint x;
  12   1              for( ; y>0; y--)
  13   1              {
  14   2                      for(x=110; x>0; x--);
  15   2              }
  16   1      }
  17          /*******************************************************************************
  18          * ï¿½ï¿½ ï¿½ï¿½ ï¿½ï¿½         : Ds18b20Init
  19          * ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½                 : ï¿½ï¿½Ê¼ï¿½ï¿½
  20          * ï¿½ï¿½    ï¿½ï¿½         : ï¿½ï¿½
  21          * ï¿½ï¿½    ï¿½ï¿½         : ï¿½ï¿½Ê¼ï¿½ï¿½ï¿½É¹ï¿½ï¿½ï¿½ï¿½ï¿½1ï¿½ï¿½Ê§ï¿½Ü·ï¿½ï¿½ï¿½0
  22          *******************************************************************************/
  23          
  24          uchar Ds18b20Init()
  25          {
  26   1              uchar i;
  27   1              DSPORT = 0;                      //ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½480us~960us
  28   1              i = 70; 
  29   1              while(i--);//ï¿½ï¿½Ê±642us
  30   1              DSPORT = 1;                     //È»ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ß£ï¿½ï¿½ï¿½ï¿½DS18B20ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Ó¦ï¿½á½«ï¿½ï¿½15us~60
             -usï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½
  31   1              i = 0;
  32   1              while(DSPORT)   //ï¿½È´ï¿½DS18B20ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½
  33   1              {
  34   2                      Delay1ms(1);
  35   2                      i++;
  36   2                      if(i>5)//ï¿½È´ï¿½>5MS
  37   2                      {
  38   3                              return 0;//ï¿½ï¿½Ê¼ï¿½ï¿½Ê§ï¿½ï¿½
  39   3                      }
  40   2              
  41   2              }
  42   1              return 1;//ï¿½ï¿½Ê¼ï¿½ï¿½ï¿½É¹ï¿½
  43   1      }
  44          
  45          /*******************************************************************************
  46          * ï¿½ï¿½ ï¿½ï¿½ ï¿½ï¿½         : Ds18b20WriteByte
  47          * ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½                 : ï¿½ï¿½18B20Ð´ï¿½ï¿½Ò»ï¿½ï¿½ï¿½Ö½ï¿½
  48          * ï¿½ï¿½    ï¿½ï¿½         : ï¿½ï¿½
  49          * ï¿½ï¿½    ï¿½ï¿½         : ï¿½ï¿½
  50          *******************************************************************************/
  51          
  52          void Ds18b20WriteByte(uchar dat)
  53          {
C51 COMPILER V9.54   TEMP                                                                  06/24/2025 21:47:26 PAGE 2   

  54   1              uint i, j;
  55   1      
  56   1              for(j=0; j<8; j++)
  57   1              {
  58   2                      DSPORT = 0;               //Ã¿Ð´ï¿½ï¿½Ò»Î»ï¿½ï¿½ï¿½ï¿½Ö®Ç°ï¿½È°ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½1us
  59   2                      i++;
  60   2                      DSPORT = dat & 0x01;  //È»ï¿½ï¿½Ð´ï¿½ï¿½Ò»ï¿½ï¿½ï¿½ï¿½ï¿½Ý£ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Î»ï¿½ï¿½Ê¼
  61   2                      i=6;
  62   2                      while(i--); //ï¿½ï¿½Ê±68usï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Ê±ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½60us
  63   2                      DSPORT = 1;     //È»ï¿½ï¿½ï¿½Í·ï¿½ï¿½ï¿½ï¿½ß£ï¿½ï¿½ï¿½ï¿½ï¿½1usï¿½ï¿½ï¿½ï¿½ï¿½ß»Ö¸ï¿½Ê±ï¿½ï¿½ï¿½ï¿½Ü½ï¿½ï¿½ï
             -¿½Ð´ï¿½ï¿½Ú¶ï¿½ï¿½ï¿½ï¿½ï¿½Öµ
  64   2                      dat >>= 1;
  65   2              }
  66   1      }
  67          /*******************************************************************************
  68          * ï¿½ï¿½ ï¿½ï¿½ ï¿½ï¿½         : Ds18b20ReadByte
  69          * ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½                 : ï¿½ï¿½È¡Ò»ï¿½ï¿½ï¿½Ö½ï¿½
  70          * ï¿½ï¿½    ï¿½ï¿½         : ï¿½ï¿½
  71          * ï¿½ï¿½    ï¿½ï¿½         : ï¿½ï¿½
  72          *******************************************************************************/
  73          
  74          
  75          uchar Ds18b20ReadByte()
  76          {
  77   1              uchar byte, bi;
  78   1              uint i, j;      
  79   1              for(j=8; j>0; j--)
  80   1              {
  81   2                      DSPORT = 0;//ï¿½È½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½1us
  82   2                      i++;
  83   2                      DSPORT = 1;//È»ï¿½ï¿½ï¿½Í·ï¿½ï¿½ï¿½ï¿½ï¿½
  84   2                      i++;
  85   2                      i++;//ï¿½ï¿½Ê±6usï¿½È´ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½È¶ï¿½
  86   2                      bi = DSPORT;     //ï¿½ï¿½È¡ï¿½ï¿½ï¿½Ý£ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Î»ï¿½ï¿½Ê¼ï¿½ï¿½È¡
  87   2                      /*ï¿½ï¿½byteï¿½ï¿½ï¿½ï¿½Ò»Î»ï¿½ï¿½È»ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½7Î»ï¿½ï¿½ï¿½biï¿½ï¿½×¢ï¿½ï¿½ï¿½Æ¶ï¿½Ö®
             -ï¿½ï¿½ï¿½Æµï¿½ï¿½ï¿½Î»ï¿½ï¿½0ï¿½ï¿½*/
  88   2                      byte = (byte >> 1) | (bi << 7);                                           
  89   2                      i = 4;          //ï¿½ï¿½È¡ï¿½ï¿½Ö®ï¿½ï¿½È´ï¿½48usï¿½Ù½ï¿½ï¿½Å¶ï¿½È¡ï¿½ï¿½Ò»ï¿½ï¿½ï¿½ï¿½
  90   2                      while(i--);
  91   2              }                               
  92   1              return byte;
  93   1      }
  94          /*******************************************************************************
  95          * ï¿½ï¿½ ï¿½ï¿½ ï¿½ï¿½         : Ds18b20ChangTemp
  96          * ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½                 : ï¿½ï¿½18b20ï¿½ï¿½Ê¼×ªï¿½ï¿½ï¿½Â¶ï¿½
  97          * ï¿½ï¿½    ï¿½ï¿½         : ï¿½ï¿½
  98          * ï¿½ï¿½    ï¿½ï¿½         : ï¿½ï¿½
  99          *******************************************************************************/
 100          
 101          void  Ds18b20ChangTemp()
 102          {
 103   1              Ds18b20Init();
 104   1              Delay1ms(1);
 105   1              Ds18b20WriteByte(0xcc);         //ï¿½ï¿½ï¿½ï¿½ROMï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½                
 106   1              Ds18b20WriteByte(0x44);     //ï¿½Â¶ï¿½×ªï¿½ï¿½ï¿½ï¿½ï¿½ï¿½
 107   1              //Delay1ms(100);        //ï¿½È´ï¿½×ªï¿½ï¿½ï¿½É¹ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Ò»Ö±Ë¢ï¿½ÅµÄ»ï¿½ï¿½ï¿½ï¿½Í²ï¿
             -½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Ê±ï¿½ï¿½
 108   1         
 109   1      }
 110          /*******************************************************************************
 111          * ï¿½ï¿½ ï¿½ï¿½ ï¿½ï¿½         : Ds18b20ReadTempCom
 112          * ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½                 : ï¿½ï¿½ï¿½Í¶ï¿½È¡ï¿½Â¶ï¿½ï¿½ï¿½ï¿½ï¿½
C51 COMPILER V9.54   TEMP                                                                  06/24/2025 21:47:26 PAGE 3   

 113          * ï¿½ï¿½    ï¿½ï¿½         : ï¿½ï¿½
 114          * ï¿½ï¿½    ï¿½ï¿½         : ï¿½ï¿½
 115          *******************************************************************************/
 116          
 117          void  Ds18b20ReadTempCom()
 118          {       
 119   1      
 120   1              Ds18b20Init();
 121   1              Delay1ms(1);
 122   1              Ds18b20WriteByte(0xcc);  //ï¿½ï¿½ï¿½ï¿½ROMï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½
 123   1              Ds18b20WriteByte(0xbe);  //ï¿½ï¿½ï¿½Í¶ï¿½È¡ï¿½Â¶ï¿½ï¿½ï¿½ï¿½ï¿½
 124   1      }
 125          /*******************************************************************************
 126          * ï¿½ï¿½ ï¿½ï¿½ ï¿½ï¿½         : Ds18b20ReadTemp
 127          * ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½                 : ï¿½ï¿½È¡ï¿½Â¶ï¿½
 128          * ï¿½ï¿½    ï¿½ï¿½         : ï¿½ï¿½
 129          * ï¿½ï¿½    ï¿½ï¿½         : ï¿½ï¿½
 130          *******************************************************************************/
 131          
 132          int Ds18b20ReadTemp()
 133          {
 134   1              int temp = 0;
 135   1              uchar tmh, tml;
 136   1              Ds18b20ChangTemp();                             //ï¿½ï¿½Ð´ï¿½ï¿½×ªï¿½ï¿½ï¿½ï¿½ï¿½ï¿½
 137   1              Ds18b20ReadTempCom();                   //È»ï¿½ï¿½È´ï¿½×ªï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Í¶ï¿½È¡ï¿½Â¶ï¿½ï¿½ï¿½ï¿½ï¿½
 138   1              tml = Ds18b20ReadByte();                //ï¿½ï¿½È¡ï¿½Â¶ï¿½Öµï¿½ï¿½16Î»ï¿½ï¿½ï¿½È¶ï¿½ï¿½ï¿½ï¿½Ö½ï¿½
 139   1              tmh = Ds18b20ReadByte();                //ï¿½Ù¶ï¿½ï¿½ï¿½ï¿½Ö½ï¿½
 140   1              temp = tmh;
 141   1              temp <<= 8;
 142   1              temp |= tml;
 143   1              return temp;
 144   1      }
 145          
 146          


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    234    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----       3
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
